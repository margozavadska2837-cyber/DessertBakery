# 0003: Стандарти API та політики кодування

**Статус:** затверджено та імплементується.  
Усі нові контролери (шар `api/`, визначений у ADR-0002) повинні суворо відповідати цим стандартам.

---

## Контекст

Оскільки DessertBakery використовує модульний моноліт із чіткими шарами, необхідно забезпечити єдиний, передбачуваний підхід до API та внутрішньої взаємодії між компонентами.

---

## Рішення та стиль API

- **Основний стиль API:** RESTful.
- **Причини вибору:**  
  REST є галузевим стандартом, забезпечує високу читабельність, масштабованість та зручність для клієнтів.

---

## Політика кодування

### Формат даних

- **Обов'язкове використання DTO:**  
  Усі дані, що надходять від клієнта (шар `api/`) і передаються далі в шар `service/`, а також усі дані з сервісного шару, що повертаються на клієнт, мають бути представлені через DTO (Data Transfer Object).
- **Мета:**  
  Забезпечити чітке розділення між зовнішнім форматом даних (DTO) та внутрішніми сутностями (`domain/`). Це запобігає небажаному змішуванню бізнес-логіки та зовнішніх контрактів.

---

## Уніфікована модель помилок

Для забезпечення передбачуваності та легкості обробки помилок на стороні клієнта запроваджується єдиний формат відповіді для помилок.

### Ключові принципи

- Завжди використовується коректний HTTP-статус-код, що відображає причину помилки:
  - `400` — помилка валідації користувацьких даних
  - `401` — немає автентифікації
  - `403` — недостатньо прав
  - `404` — ресурс не знайдено

---

### Приклад формату помилки

```json
{
  "status": "error",
  "code": 400,
  "message": "Вхідні дані не пройшли валідацію.",
  "details": [
    {
      "field": "name",
      "error": "Ім'я не може бути пустим."
    },
    {
      "field": "email",
      "error": "Некоректний формат електронної пошти."
    }
  ],
  "timestamp": "2025-10-10T21:00:00Z"
}
```

| Поле      | Опис                                                                                                           |
|-----------|----------------------------------------------------------------------------------------------------------------|
| status    | Завжди "error".                                                                                                |
| code      | HTTP статус-код помилки.                                                                                       |
| message   | Коротке, зрозуміле для користувача пояснення помилки.                                                          |
| details   | Масив об'єктів для помилок валідації. Містить деталі (поле та причина).                                        |
| timestamp | Час виникнення помилки (у форматі ISO 8601).                                                                   |

---
